angular.module("flapperNews",["flapperNews.authentication","flapperNews.slider","flapperNews.posts","flapperNews.home"]),angular.module("flapperNews.authentication",["ui.router"]).config(["$stateProvider",function(e){e.state("login",{url:"/login",templateUrl:"app/authentication/auth.login.html",controller:"AuthCtrl",onEnter:["$state","auth",function(e,t){t.isLoggedIn()&&e.go("home")}]}).state("register",{url:"/register",templateUrl:"app/authentication/auth.register.html",controller:"AuthCtrl",onEnter:["$state","auth",function(e,t){t.isLoggedIn()&&e.go("home")}]})}]),angular.module("flapperNews.authentication").controller("AuthCtrl",["$scope","$state","auth",function(e,t,n){e.user={},e.register=function(){n.register(e.user).error(function(t){e.error=t}).then(function(){t.go("home")})},e.logIn=function(){n.logIn(e.user).error(function(t){e.error=t}).then(function(){t.go("home")})}}]),angular.module("flapperNews.authentication").factory("auth",["$http","$window",function(e,t){var n={};return n.saveToken=function(e){t.localStorage["flapper-news-token"]=e},n.getToken=function(){return t.localStorage["flapper-news-token"]},n.isLoggedIn=function(){var e=n.getToken();if(e){var r=JSON.parse(t.atob(e.split(".")[1]));return r.exp>Date.now()/1e3}return!1},n.currentUser=function(){if(n.isLoggedIn()){var e=n.getToken(),r=JSON.parse(t.atob(e.split(".")[1]));return r.username}},n.register=function(t){return e.post("/register",t).success(function(e){n.saveToken(e.token)})},n.logIn=function(t){return e.post("/login",t).success(function(e){n.saveToken(e.token)})},n.logOut=function(){t.localStorage.removeItem("flapper-news-token")},n}]),angular.module("flapperNews.home",["ui.router"]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("home",{url:"/home",templateUrl:"app/home/home.template.html",controller:"HomeCtrl",resolve:{postPromise:["posts",function(e){return e.getAll()}]}}),t.otherwise("home")}]),angular.module("flapperNews.home").controller("HomeCtrl",["$scope","posts","auth",function(e,t,n){e.isLoggedIn=n.isLoggedIn,e.posts=t.posts,e.addPost=function(){e.title&&""!==e.title&&(t.create({title:e.title,link:e.link}),e.title="",e.link="")},e.incrementUpvotes=function(e){t.upvote(e)},e.decrementUpvotes=function(e){t.downvote(e)}}]),angular.module("flapperNews").controller("NavCtrl",["$scope","auth",function(e,t){e.isLoggedIn=t.isLoggedIn,e.currentUser=t.currentUser,e.logOut=t.logOut}]),angular.module("flapperNews.posts",["ui.router"]).config(["$stateProvider",function(e){e.state("posts",{url:"/posts/{id}",templateUrl:"app/posts/posts.template.html",controller:"PostsCtrl",resolve:{post:["$stateParams","posts",function(e,t){return t.get(e.id)}]}})}]),angular.module("flapperNews.posts").controller("PostsCtrl",["$scope","posts","post",function(e,t,n){e.post=n,e.addComment=function(){""!==e.body&&(t.addComment(n._id,{body:e.body,author:"user"}).success(function(t){e.post.comments.push(t)}),e.body="")},e.incrementCommentUpvotes=function(e){t.upvoteComment(n,e)},e.decrementCommentUpvotes=function(e){t.downvoteComment(n,e)}}]),angular.module("flapperNews.posts").factory("posts",["$http","auth",function(e,t){var n={posts:[]};return n.getAll=function(){return e.get("/posts").success(function(e){angular.copy(e,n.posts)})},n.create=function(r){return e.post("/posts",r,{headers:{Authorization:"Bearer "+t.getToken()}}).success(function(e){n.posts.push(e)})},n.upvote=function(n){return e.put("/posts/"+n._id+"/upvote",null,{headers:{Authorization:"Bearer "+t.getToken()}}).success(function(e){n.upvotes+=1})},n.downvote=function(n){return e.put("/posts/"+n._id+"/downvote",null,{headers:{Authorization:"Bearer "+t.getToken()}}).success(function(e){n.upvotes-=1})},n.get=function(t){return e.get("/posts/"+t).then(function(e){return e.data})},n.addComment=function(n,r){return e.post("/posts/"+n+"/comments",r,{headers:{Authorization:"Bearer "+t.getToken()}})},n.upvoteComment=function(n,r){return e.put("/posts/"+n._id+"/comments/"+r._id+"/upvote",null,{headers:{Authorization:"Bearer "+t.getToken()}}).success(function(e){r.upvotes+=1})},n.downvoteComment=function(n,r){return e.put("/posts/"+n._id+"/comments/"+r._id+"/downvote",null,{headers:{Authorization:"Bearer "+t.getToken()}}).success(function(e){r.upvotes-=1})},n}]),angular.module("flapperNews.slider",["ngAnimate"]),angular.module("flapperNews.slider").controller("SliderController",function(e){e.images=[{src:"img1.png",title:"Pic 1"},{src:"img2.jpg",title:"Pic 2"},{src:"img3.jpg",title:"Pic 3"},{src:"img4.png",title:"Pic 4"},{src:"img5.png",title:"Pic 5"}]}),angular.module("flapperNews.slider").directive("slider",function(e){return{restrict:"AE",replace:!0,scope:{images:"="},link:function(e,t,n){e.currentIndex=0,e.next=function(){e.currentIndex<e.images.length-1?e.currentIndex++:e.currentIndex=0},e.prev=function(){e.currentIndex>0?e.currentIndex--:e.currentIndex=e.images.length-1},e.$watch("currentIndex",function(){e.images.forEach(function(e){e.visible=!1}),e.images[e.currentIndex].visible=!0})},templateUrl:"app/slider/slider.template.html"}}),angular.module("flapperNews.templates",[]).run(["$templateCache",function(e){e.put("app/authentication/auth.login.html",'<div class="page-header">\r\n  <h1>Flapper News</h1>\r\n</div>\r\n\r\n<div ng-show="error" class="alert alert-danger row">\r\n  <span>{{ error.message }}</span>\r\n</div>\r\n\r\n<form ng-submit="logIn()" style="margin-top:30px;">\r\n  <h3>Log In</h3>\r\n\r\n  <div class="form-group">\r\n    <input type="text" class="form-control" placeholder="Username" ng-model="user.username"></input>\r\n  </div>\r\n  <div class="form-group">\r\n    <input type="password" class="form-control" placeholder="Password" ng-model="user.password"></input>\r\n  </div>\r\n  <button type="submit" class="btn btn-primary">Log In</button>\r\n</form>\r\n'),e.put("app/authentication/auth.register.html",'<div class="page-header">\r\n  <h1>Flapper News</h1>\r\n</div>\r\n\r\n<div ng-show="error" class="alert alert-danger row">\r\n  <span>{{ error.message }}</span>\r\n</div>\r\n\r\n<form ng-submit="register()" style="margin-top:30px;">\r\n  <h3>Register</h3>\r\n\r\n  <div class="form-group">\r\n    <input type="text" class="form-control" placeholder="Username" ng-model="user.username"></input>\r\n  </div>\r\n  <div class="form-group">\r\n    <input type="password" class="form-control" placeholder="Password" ng-model="user.password"></input>\r\n  </div>\r\n  <button type="submit" class="btn btn-primary">Register</button>\r\n</form>\r\n'),e.put("app/home/home.template.html",'<div class="page-header">\r\n  <h1>FlapperNews</h1>\r\n</div>\r\n<div ng-repeat="post in posts | orderBy: \'-upvotes\'">\r\n  <p>\r\n    {{$index+1}}.\r\n    <span class="glyphicon glyphicon-thumbs-up" ng-click="incrementUpvotes(post)"></span>\r\n    <span class="glyphicon glyphicon-thumbs-down" ng-click="decrementUpvotes(post)"></span>\r\n    <a href={{post.link}} ng-show=\'post.link\'>{{post.title}}</a>\r\n    <span ng-hide=\'post.link\'>{{post.title}}</span>\r\n    <span ng-show="post.author">\r\n      posted by <a>{{post.author}}</a>\r\n    </span>\r\n    | votes: {{post.upvotes}}\r\n    <span> <a href="#/posts/{{post._id}}">Comments</a></span>\r\n  </p>\r\n</div>\r\n<form ng-submit="addPost()" ng-show="isLoggedIn()">\r\n  <div class="form-group">\r\n    <input class="form-control" placeholder="Title" type="text" ng-model="title" />\r\n  </div>\r\n  <div class="form-group">\r\n    <input class="form-control" placeholder="Link" type="text" ng-model="link" />\r\n  </div>\r\n  <button type="submit">Post</button>\r\n</form>\r\n<div ng-hide="isLoggedIn()">\r\n  <h3>You need to <a href="/#/login">Log In</a> or <a href="/#/register">Register</a> before you can add a post.</h3>\r\n</div>\r\n'),e.put("app/posts/posts.template.html",'<div class="page-header">\r\n  <h3>\r\n    <a href={{post.link}} ng-show=\'post.link\'>{{post.title}}</a>\r\n    <span ng-hide=\'post.link\'>{{post.title}}</span>\r\n  </h3>\r\n</div>\r\n<div ng-repeat="comment in post.comments | orderBy:\'-upvotes\'">\r\n  <span class="glyphicon glyphicon-thumbs-up" ng-click="incrementCommentUpvotes(comment)"></span>\r\n  <span class="glyphicon glyphicon-thumbs-down" ng-click="decrementCommentUpvotes(comment)"></span>\r\n  {{comment.body}} - by {{comment.author}} | votes: {{comment.upvotes}}\r\n</div>\r\n\r\n<form ng-submit="addComment()" ng-show="isLoggedIn()" style="margin-top:30px">\r\n  <h3>Add a new comment</h3>\r\n  <div class="form-group">\r\n    <input type="text" class="form-control" ng-model="body" placeholder="Comment" </div>\r\n    <br/>\r\n    <button class="btn btn-primary" type="submit">Add</button>\r\n</form>\r\n<div ng-hide="isLoggedIn()">\r\n  <h3>You need to <a href="/#/login">Log In</a> or <a href="/#/register">Register</a> before you can comment.</h3>\r\n</div>\r\n'),e.put("app/slider/slider.template.html",'<div class="slider">\n  <div class="slide" ng-repeat="image in images" ng-show="image.visible">\n    <img ng-src="img/{{image.src}}" />\n  </div>\n  <div class="arrows">\n    <a href="#" ng-click="prev()">\n      <img src="img/left-arrow.png" />\n    </a>\n    <a href="#" ng-click="next()">\n      <img src="img/right-arrow.png" />\n    </a>\n  </div>\n</div>\n')}]);
//# sourceMappingURL=../maps/js/app.js.map
